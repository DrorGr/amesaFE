# AmesaBase Project - Frontend - Cursor Rules

## Project Overview
AmesaBase is a lottery management system with Angular frontend, .NET backend, and AWS infrastructure. The application is a property lottery platform featuring a "4Wins Model" where profits support community causes.

## Workspace Structure
**âš ï¸ This repository is part of the AmesaBase-Monorepo workspace**
- **Monorepo Root**: `C:\Users\dror0\Curser-Repos\AmesaBase-Monorepo\`
- **This Repository (FE/)**: Angular frontend â†’ https://github.com/DrorGr/amesaFE
- **Backend (BE/)**: .NET 8.0 backend â†’ https://github.com/DrorGr/amesaBE
- **MetaData/**: Cross-cutting docs, scripts, and configs

## Repository Structure
- **AmesaFE** (Current): Angular 20.2.1 frontend â†’ AWS S3 + CloudFront
- **AmesaBE**: .NET 8.0 backend â†’ Docker + ECS
- **AmesaDevOps**: Infrastructure as Code

## Technology Stack
- **Frontend**: Angular 20.2.1, TypeScript 5.9.2, Tailwind CSS 3.4.3
- **Backend**: .NET 8.0, Docker, Aurora PostgreSQL
- **Infrastructure**: AWS (S3, CloudFront, ECS, ALB, Aurora)
- **CI/CD**: GitHub Actions
- **Version Control**: Git with GitHub repositories
- **Package Management**: npm (frontend), NuGet (backend)

## Current Status (2025-10-31)
- **Production environment fully operational** âœ…
- **Backend Admin Panel**: âœ… Deployed and working on production
- **CloudFront configurations**: API routing configured
- **Backend connectivity**: Database authentication resolved + Admin panel accessible
- **API endpoints**: All working correctly through CloudFront
- **Working tree**: Clean, all changes committed
- **Branch**: main

## Environment URLs
- **Production**: https://dpqbvdgnenckf.cloudfront.net
- **Local Development**: http://localhost:4200

## Backend API Endpoints
- **Production**: 
  - API: amesa-backend-alb-509078867.eu-north-1.elb.amazonaws.com
  - Admin Panel: http://amesa-backend-alb-509078867.eu-north-1.elb.amazonaws.com/admin âœ…
- **Local Development**: 
  - API: http://localhost:5000
  - Admin Panel: http://localhost:5000/admin

## CloudFront Distributions
- **Production**: E3GU3QXUR43ZOH (with API routing configured)

## Coding Standards

### Angular/TypeScript
- Use standalone components architecture
- Follow Angular 20.2.1 best practices
- Implement lazy loading with custom preloading strategy
- Use TypeScript strict mode
- Follow Tailwind CSS utility-first approach
- Implement proper error handling and logging

### Environment Configuration
- Use external configuration injection
- Never hardcode environment-specific values
- Maintain separate configs for local development and production
- Use GitHub secrets for sensitive data

### AWS Infrastructure
- Follow serverless architecture patterns
- Use proper CloudFront origin path configurations
- Implement proper cache invalidation strategies
- Maintain environment isolation
- **Region**: eu-north-1
- **Account**: 129394705401
- **S3 Buckets**: amesa-frontend-prod
- **CloudFront Distributions**: Production distribution with API routing configured
- **ECS Cluster**: "Amesa" with Fargate launch type
- **Aurora PostgreSQL**: Serverless v2 production cluster
- **API Routing**: CloudFront `/api/*` routes proxy to backend ALB

## File Structure Guidelines
- Keep context files updated with current status
- Maintain comprehensive documentation
- Use consistent naming conventions
- Organize components by feature

## Documentation Requirements
- Update context files when making significant changes
- Document all infrastructure changes
- Maintain troubleshooting guides
- Keep deployment status current

## Important Notes
- **Angular builds deploy to `browser/` subdirectory** - CloudFront configured without origin path (files at root)
- **Environment files are in `src/environments/`** - Local development and production configurations
- **Local development** - Uses localhost backend (http://localhost:5000)
- **Production** - Uses dedicated production ALB
- **CloudFront API routing** - `/api/*` paths automatically proxy to backend ALB

## Context Files to Maintain

### In This Repository (FE/):
- `CONTEXT_QUICK_REFERENCE.md` - Frontend quick reference
- `CURRENT_WORK.md` - Frontend current tasks and status
- `CURRENT_STATUS_SUMMARY.md` - Frontend latest status overview

### In Monorepo MetaData/ (Cross-cutting):
- `../MetaData/Documentation/DEPLOYMENT_STATUS_REPORT.md` - All environments status
- `../MetaData/Documentation/AWS_INFRASTRUCTURE_DETAILS.md` - Infrastructure details
- `../MetaData/Documentation/TROUBLESHOOTING.md` - Common issues and solutions
- `../MetaData/Documentation/ENVIRONMENT_URLS_REFERENCE.md` - Comprehensive URLs
- `../MetaData/Reference/ENVIRONMENT_URLS_GRID.csv` - CSV for team sharing
- `../MetaData/Reference/AmesaEnvironmentGrid.gs` - Google Apps Script
- `../MetaData/Scripts/` - Deployment and utility scripts
- `../MetaData/Configs/` - CloudFront, S3, ECS configurations

## Agent Instructions
- Always check context files for current project status
- Update relevant context files when making changes
- Follow the established patterns and conventions
- Maintain environment consistency for local development and production
- Document any infrastructure or configuration changes
- **CRITICAL**: If any changes relate to project structure, environment configuration, infrastructure, or deployment processes, update the appropriate context files and this .cursorrules file

## Architecture Overview

### GitHub Repository Structure
- **amesaFE**: https://github.com/DrorGr/amesaFE (Frontend)
- **amesaBE**: https://github.com/DrorGr/amesaBE (Backend)
- **amesaDevOps**: Infrastructure as Code repository

### AWS Architecture
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend      â”‚    â”‚     Backend      â”‚    â”‚    Database     â”‚
â”‚                 â”‚    â”‚                  â”‚    â”‚                 â”‚
â”‚ Angular 20.2.1  â”‚â”€â”€â”€â–¶â”‚ .NET 8.0 + Dockerâ”‚â”€â”€â”€â–¶â”‚ Aurora PostgreSQLâ”‚
â”‚ S3 + CloudFront â”‚    â”‚ ECS Fargate      â”‚    â”‚ Serverless v2   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Deployment Flow
1. **Production**: Push to main branch â†’ Auto-deploy to S3/CloudFront
2. **Local Development**: Run `ng serve` for local testing

## Common Commands
```bash
# Frontend development
npm install
ng serve
ng build --configuration=production

# AWS operations
aws cloudfront list-distributions
aws s3 ls s3://amesa-frontend-prod/ --recursive
aws cloudfront create-invalidation --distribution-id E3GU3QXUR43ZOH --paths "/*"

# ECS operations
aws ecs list-services --cluster Amesa
aws ecs describe-services --cluster Amesa --services amesa-backend-service

# Database operations
aws rds describe-db-clusters --db-cluster-identifier amesadbmain

# Git operations
git status
git log --oneline -5
git checkout main
```

## Business Context
- **4Wins Model**: Winner gets property, community gets support, company gets sustainable business, society gets social impact
- **Legal Partners**: Zeiba & Partners (legal), PiK Podatki (accounting)
- **Responsible Gaming**: Built-in responsible gambling features
- **Multi-language Support**: Internationalization with translation service
- **Theme Support**: Dark/light mode switching
- **Real-time Features**: SignalR integration for live updates

## Recent Changes (2025-11-21) - USER PREFERENCES & TRANSLATION FIXES
- âœ… **User Preferences System** - Complete implementation with 8 preference categories
- âœ… **Polish Language Support** - 6th language added with full translation coverage
- âœ… **Translation System Fixed** - Removed fallback dependencies, API-only approach
- âœ… **Console Log Cleanup** - Production performance optimization
- âœ… **Translation Loader** - Better UX with loading states and timeout handling
- âœ… **Theme Service Refactor** - Improved independence and conflict resolution
- âœ… **Type Safety** - Complete TypeScript interfaces for all preference models

## Previous Changes (2025-10-31)
- **Context Files Updated** - Removed dev/staging references, production-only setup
- **Environment Configuration Simplified** - Local development and production only
- **OAuth Integration Plan** - Comprehensive plan document created

## ğŸ“š **Session Documentation**
**Latest Session**: [Database Seeding & Translation System Fix](../MetaData/Documentation/2025-11-21-Database-Seeding-And-Translations/README.md)
- User Preferences System handoff
- Translation system architecture
- Polish language implementation
- Performance optimizations

---
**Last Updated**: 2025-11-21
**Note**: This file should be updated whenever project structure, environment configuration, infrastructure, or deployment processes change.
